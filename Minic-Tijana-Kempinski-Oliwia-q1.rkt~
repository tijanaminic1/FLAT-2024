#lang fsm
(require lang/htdp-advanced)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; Quiz 1
;; Chapter 2, Nr.17
;; Tijana Minic and Oliwia Kempinski

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; Design and implement a function to print the integer pairs in a 2D Cartesian plane.

;; posn symbol -> posn
;; Purpose: Given a posn and a direction, determine the next posn
(define (next-posn p dir)
  (cond [(eq? dir 'right) (make-posn (add1 (posn-x p)) (posn-y p))]
        [(eq? dir 'up) (make-posn (posn-x p) (add1 (posn-y p)))]
        [(eq? dir 'left) (make-posn (sub1 (posn-x p)) (posn-y p))]
        [else (make-posn (posn-x p) (sub1 (posn-y p)))]))

;; Tests for next-posn

;.................................................

;; symbol integer integer -> symbol
;; Purpose: Find new direction, if direction changes 
(define (next-dir dir len counter)
  (local (;; -> symbol
          ;; Purpose: Find the new direction 
          (define (next-dir-helper)
            (cond [(eq? dir 'right) 'up]
                  [(eq? dir 'up) 'left]
                  [(eq? dir 'left) 'down]
                  [else 'right])))
    (if (= len counter)
        (next-dir-helper)
        dir)))

;; Tests for next-dir

;.................................................

;; integer symbol boolean -> integer
;; Purpose: Find the next length
(define (next-len len dir change-len?)
  (if (and change-len?
           (or (eq? dir 'right)
               (eq? dir 'left)))
      (add1 len)
      len))

;; Tests for next-len

;.................................................

;; integer integer -> integer
;; Purpose: Set the counter
(define (next-counter len counter)
  (if (= len counter)
      0
      (add1 counter)))

;; Tests for next-counter

;.................................................

;; integer integer boolean-> boolean
;; Purpose: Adjust change-len? boolean
(define (next-cglen len counter change-len?)
  (cond [(and (= counter len)
              change-len?) #f]
        [(and (= counter len)
              (not change-len?)) #t]
        [else change-len?]))
           

;; Tests for next-cglen

;.................................................

;; Data Definitions:
;; p           = posn
;; dir         = direction of arrow
;; len         = length the sequential arrows pointing in the same direction
;; counter     = keeps track of traversed arrows in len
;; change-len? = if true, len will increase by 1 at next direction change

;; -> (void)
;; Purpose: Print the integer pairs in a 2D Cartesian planes
(define (print-coords)
  (local (;; posn -> (void)
          ;; Purpose: Print the next posn, and make recursive call
          (define (printer p dir len counter change-len?)
            (if #;(= p +inf.0) (= len 5)
                (void)
                (begin
                  p
                  (printer (next-posn p dir)
                           (next-dir dir len counter)
                           (next-len len dir change-len?)
                           (next-counter len counter)
                           (next-cglen len counter change-len?))))))
    (printer (make-posn 0 0) 'right 1 0 #f)))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
